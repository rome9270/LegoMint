<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EV3 · Motor-only check (A/B normal, C only 10°)</title>

  <!-- Use your external stylesheet (same look as before) -->
  <link rel="stylesheet" href="../css/01_mainEV.css">
</head>
<body>
  <div class="hero">
    <h1>LEGO EV3 — Motor-only Function Check</h1>
  </div>

  <a class="btn btn--back" href="01_main.html">← Back to overview</a>

  <main>
    <h2>Test motors only (A/B normal, C only 10°)</h2>
    <div class="card">
<textarea id="code" spellcheck="false">#!/usr/bin/env pybricks-micropython
# EV3 – Motor-only check: A/B forward+back, C only 10°

from pybricks.hubs import EV3Brick
from pybricks.ev3devices import Motor
from pybricks.parameters import Port, Direction, Stop
from pybricks.tools import wait

ev3 = EV3Brick()

# ---- small helpers ----
def beep(freq=800, dur=100):
    try:
        ev3.speaker.beep(freq, dur)
    except:
        pass

def init_motor(port):
    try:
        return Motor(port, positive_direction=Direction.CLOCKWISE)
    except:
        return None

# ---- auto-detect motors (None if not plugged in) ----
mA = init_motor(Port.A)
mB = init_motor(Port.B)
mC = init_motor(Port.C)

# ---- motor tests ----
def test_motor_AB(m, label):
    """A/B: short forward/backward test."""
    if m is None:
        print("Motor "+label+": not found")
        return
    try:
        start = m.angle()
        m.run_angle(300, 180); wait(150)
        m.run_angle(300,-180); wait(150)
        end = m.angle()
        delta = abs(end - start)
        ok = delta >= 120  # rough plausibility
        print("Motor "+label+": delta="+str(int(delta))+" -> "+("OK" if ok else "FAIL"))
        m.stop(Stop.BRAKE)
    except Exception as e:
        print("Motor "+label+": error: "+str(e))

def test_motor_C_10deg(m):
    """C: exactly 10°."""
    if m is None:
        print("Motor C: not found")
        return
    try:
        SPEED_DPS = 100
        ANGLE_DEG = 10   # use -10 for reverse
        m.run_angle(SPEED_DPS, ANGLE_DEG); wait(100)
        m.stop(Stop.BRAKE)
        print("Motor C: 10 degrees OK")
    except Exception as e:
        print("Motor C: error: "+str(e))

# ---- program flow ----
def main():
    beep(900,120)
    print("== Start: motor-only check (A/B & C 10°) ==")

    test_motor_AB(mA, "A")
    test_motor_AB(mB, "B")
    test_motor_C_10deg(mC)

    beep(1000,120)
    print("== End ==")

if __name__ == "__main__":
    try:
        main()
    finally:
        try:
            if mA: mA.stop(Stop.BRAKE)
            if mB: mB.stop(Stop.BRAKE)
            if mC: mC.stop(Stop.BRAKE)
        except Exception:
            pass
</textarea>

      <div class="actions">
        <button id="download" class="btn">Download as main.py</button>
        <span class="small">Pybricks firmware on the EV3 is required.</span>
      </div>
    </div>
  </main>

  <script>
    // JS: grabs the text from the editor and saves it as "main.py".
    document.getElementById('download').addEventListener('click', function () {
      var src = document.getElementById('code').value;
      var blob = new Blob([src], {type:'text/x-python'});
      var url  = URL.createObjectURL(blob);
      var a    = document.createElement('a');
      a.href = url; a.download = 'main.py'; a.click();
      setTimeout(function(){ URL.revokeObjectURL(url); }, 0);
    });
  </script>
</body>
</html>
