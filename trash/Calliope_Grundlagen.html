<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="CALLIOPE mini â€“ Grundlagen & Aufgaben (einfach)" />
  <link href="../CSS/01_main.css" rel="stylesheet" />
  <title>CALLIOPE mini â€“ Grundlagen & Aufgaben</title>
  <style>
    /* bewusst sehr schlicht gehalten */
    :root {
      --ink:#111827; --muted:#6b7280; --line:#e5e7eb; --bg:#ffffff; --pill:#f3f4f6; --brand:#111827;
    }
    body { max-width: 980px; margin: 0 auto; padding: 1rem; }
    h1, h2, h3 { margin: .25rem 0 .5rem; }
    p { margin: .25rem 0 .5rem; }
    .muted { color: var(--muted); }
    .pill { background: var(--pill); padding: .35rem .7rem; border-radius: 9999px; font-weight: 600; }
    .grid { display: grid; gap: .75rem; }
    .grid-2 { grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); }
    .card { border: 1px solid var(--line); border-radius: 12px; padding: 1rem; background: var(--bg); }
    .btn { display:inline-block; padding:.6rem .9rem; border-radius:9999px; text-decoration:none; background:var(--brand); color:#fff; font-weight:700; }
    .btn.light { background: var(--pill); color: var(--ink); }
    .actions { display:flex; flex-wrap:wrap; gap:.5rem; margin-top:.5rem; }
    .level-grid { display:grid; gap:.75rem; grid-template-columns: repeat(auto-fit, minmax(180px,1fr)); margin:.5rem 0 1rem; }
    .level-btn { text-align:center; padding:.9rem 1rem; border-radius:10px; background: var(--pill); color: var(--ink); text-decoration:none; font-weight:700; }
    .media { display:grid; gap:.5rem; grid-template-columns: repeat(auto-fit, minmax(220px,1fr)); }
    figure { margin:0; border:1px dashed var(--line); padding:.5rem; border-radius:10px; background:#fff; }
    figure img { width:100%; height:auto; border-radius:8px; }
    figure figcaption { font-size:.9rem; color:var(--muted); margin-top:.25rem; }
    .task { border:1px solid var(--line); border-radius:12px; padding:.9rem; background:#fff; display:flex; flex-direction:column; gap:.4rem; }
    .task.done { opacity:.65; }
    .task .t-head { display:flex; align-items:center; gap:.5rem; }
    .progress { height:10px; background:#f3f4f6; border-radius:9999px; overflow:hidden; }
    .progress > span { display:block; height:100%; background:#16a34a; width:0%; transition:width .3s ease; }
    .badge { font-size:.85rem; padding:.2rem .5rem; border-radius:9999px; background:#eef2ff; color:#3730a3; font-weight:700; }
    .back { margin-top:1rem; }

    /* kleines GlÃ¼ckwunsch-Overlay */
    .overlay { position:fixed; inset:0; background:rgba(0,0,0,.5); display:none; align-items:center; justify-content:center; z-index:50; }
    .overlay.show { display:flex; }
    .modal { background:#fff; border-radius:16px; padding:1rem 1.2rem; max-width:420px; width:92%; text-align:center; }
    .big { font-size:2.2rem; }
  </style>
</head>
<body>
  <header>
    <div class="pill">Calliope mini</div>
    <h1>Aufgabe 1 â€“ LEDâ€‘Herz blinken</h1>
    <p class="muted">Erstelle die Aufgabe zuerst mit BlÃ¶cken (Drag & Drop). Optional: Zeige dir den JavaScriptâ€‘Code an und â€“ falls euer Setup es unterstÃ¼tzt â€“ probiere MicroPython.</p>
    <hr/>
  </header>

  <!-- GRUNDLAGEN -->
  

  <!-- AUFGABEN -->
  <section id="aufgaben" style="margin-top:.75rem;">
    <div class="card">
      <h2 style="margin-top:0;">So gehst du vor</h2>
      <ol>
        <li><strong>Editor Ã¶ffnen</strong> (Button unten). Teste rechts im Simulator.</li>
        <li><strong>BlÃ¶cke (Drag & Drop)</strong>:
          <ul>
            <li>Ziehe einen <em>dauerhaft</em>-Block auf die FlÃ¤che.</li>
            <li>In den Block: <em>zeige Icon â†’ Herz</em> â†’ <em>pausiere 500 ms</em> â†’ <em>Bildschirm lÃ¶schen/zeige LEDs (leer)</em> â†’ <em>pausiere 500 ms</em>.</li>
            <li>Der Simulator sollte nun abwechselnd Herz / aus blinken.</li>
          </ul>
        </li>
        <li><strong>Herunterladen</strong> â†’ die <code>.hex</code>-Datei wird gespeichert.</li>
        <li><strong>Umbenennen</strong>: Speichere mit deinem Namen & Aufgabe, z.â€¯B. <code>MaxMuster_Aufgabe1.hex</code> (oder <code>VornameNachname_A1.hex</code>).</li>
        <li><strong>Auf Calliope kopieren</strong>: Ziehe die <code>.hex</code> auf das Laufwerk <em>MINI</em> â†’ LED blinkt â†’ Programm startet.</li>
        <li><strong>Fertig?</strong> Editorâ€‘Tab schlieÃŸen <em>oder</em> hier â€žGeschafft âœ“â€œ klicken â†’ Gratulationsâ€‘Hinweis erscheint.</li>
      </ol>

      <div class="actions" style="margin-top:.6rem;">
        <button class="btn" id="openEditor">Im Microsoftâ€‘Editor lÃ¶sen</button>
        <button class="btn light" id="markDone">Geschafft âœ“</button>
        <button class="btn light" id="closeEditor" style="display:none;">Editorâ€‘Fenster schlieÃŸen</button>
      </div>

      <details style="margin-top:.8rem;">
        <summary><strong>Optional:</strong> JavaScript im MakeCode anzeigen</summary>
        <pre class="mono">basic.forever(function () {
  basic.showIcon(IconNames.Heart)
  basic.pause(500)
  basic.clearScreen()
  basic.pause(500)
})</pre>
      </details>

      <details style="margin-top:.6rem;">
        <summary><strong>Optional:</strong> Python (MicroPython â€“ falls bei euch verfÃ¼gbar)</summary>
        <p class="muted">Nur nutzen, wenn ihr einen MicroPythonâ€‘Workflow fÃ¼r den Calliope mini habt (z.â€¯B. separater MicroPythonâ€‘Editor). Der Code zeigt das Herz im Wechsel an/aus:</p>
        <pre class="mono">from microbit import *

while True:
    display.show(Image.HEART)
    sleep(500)
    display.clear()
    sleep(500)</pre>
        <p class="muted">Speichere die Datei z.â€¯B. als <code>MaxMuster_Aufgabe1.py</code>. Das genaue Flashâ€‘Vorgehen hÃ¤ngt von eurem Pythonâ€‘Setup ab.</p>
      </details>
    </div>
  </section>

  <!-- ZURÃœCK -->
  <div class="back">
    <a href="02_middle.html" class="level-btn">zurÃ¼ck</a>
  </div>
  <div class="back">
    <a href="02_middle.html" class="level-btn">zurÃ¼ck</a>
  </div>

  <!-- GlÃ¼ckwunsch-Overlay -->
  <div id="gg" class="overlay" aria-hidden="true" role="dialog">
    <div class="modal">
      <div class="big" aria-live="polite" aria-atomic="true">ðŸŽ‰ GlÃ¼ckwunsch!</div>
      <p>Du hast diese Aufgabe abgehakt. Super gemacht!</p>
      <div class="actions" style="justify-content:center;">
        <button class="btn light" id="ggBack">Zur Aufgabenliste</button>
        <button class="btn" id="ggNext">NÃ¤chste Aufgabe</button>
      </div>
    </div>
  </div>

  <script>
  // Einfache Steuerung fÃ¼r EINEN Task + Editor-Fenster
  const editorURL = 'https://makecode.calliope.cc/#editor';
  const openBtn = document.getElementById('openEditor');
  const doneBtn = document.getElementById('markDone');
  const closeBtn = document.getElementById('closeEditor');
  const overlay = document.getElementById('gg');
  const ggBack = document.getElementById('ggBack');
  const ggNext = document.getElementById('ggNext');

  let editorWin = null;
let checkTimer = null;

  // Editor in neuem Tab/Fenster Ã¶ffnen und Referenz speichern
  openBtn?.addEventListener('click', () => {
    editorWin = window.open(editorURL, '_blank', 'noopener');
    if (editorWin) {
      closeBtn.style.display = '';
      // alle 800ms prÃ¼fen, ob der Editor-Tab geschlossen wurde
      if (checkTimer) clearInterval(checkTimer);
      checkTimer = setInterval(() => {
        try {
          if (editorWin.closed) {
            clearInterval(checkTimer); checkTimer = null;
            // automatisch Gratulation anzeigen
            overlay?.classList.add('show');
            overlay?.setAttribute('aria-hidden','false');
          }
        } catch (e) {
          // Ignorieren â€“ Cross-Origin schÃ¼tzt vor Zugriff, closed-Flag bleibt lesbar
        }
      }, 800);
    }
  });

  // Optional: Versuche das Editor-Fenster zu schlieÃŸen (geht nur, wenn von dieser Seite geÃ¶ffnet)
  closeBtn?.addEventListener('click', () => {
    try { editorWin?.close(); } catch(e) {}
  });

  // Geschafft-Overlay anzeigen
  doneBtn?.addEventListener('click', () => {
    overlay?.classList.add('show');
    overlay?.setAttribute('aria-hidden','false');
  });

  // Zur Aufgabenliste (Overlay schlieÃŸen)
  ggBack?.addEventListener('click', () => {
    overlay?.classList.remove('show');
    overlay?.setAttribute('aria-hidden','true');
  });

  // NÃ¤chste Aufgabe â€“ gibt es hier nicht, einfach zurÃ¼ck zur Liste
  ggNext?.addEventListener('click', () => {
    overlay?.classList.remove('show');
    overlay?.setAttribute('aria-hidden','true');
  });
</script>
</body>
</html>
